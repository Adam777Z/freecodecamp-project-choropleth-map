const projectName="choropleth";localStorage.setItem("example_project","D3: Choropleth"),document.addEventListener("DOMContentLoaded",a=>{const e="./assets/json/counties.json",t="./assets/json/education.json";Promise.all([e,t].map(a=>d3.json(a))).then(a=>{const e=a[0],t={};a[1].forEach(a=>{t[a.fips]=a,delete t[a.fips].fips});const s={AL:"Alabama",AK:"Alaska",AS:"American Samoa",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",DC:"District Of Columbia",FM:"Federated States Of Micronesia",FL:"Florida",GA:"Georgia",GU:"Guam",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MH:"Marshall Islands",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",MP:"Northern Mariana Islands",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PW:"Palau",PA:"Pennsylvania",PR:"Puerto Rico",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VI:"Virgin Islands",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"},n=1032,o=600,r=d3.geoPath(),i=d3.select("body").append("div").attr("id","tooltip"),l=d3.select("#canvas").append("svg").attr("width",n).attr("height",o),d=d3.scaleThreshold().domain(((a,e,t)=>{let s=[],n=(e-a)/t,o=a;for(let a=1;a<t;a++)s.push(o+a*n);return s})(d3.min(Object.keys(t).map(a=>t[a].bachelorsOrHigher)),d3.max(Object.keys(t).map(a=>t[a].bachelorsOrHigher)),d3.schemeGreens[9].length)).range(d3.schemeGreens[9]),c=d3.scaleLinear().domain(d3.extent(Object.keys(t).map(a=>t[a].bachelorsOrHigher))).range([0,n/2.5]),h=d3.axisBottom(c).tickValues(d.domain()),p=l.append("g").attr("id","legend").attr("transform","translate("+n/2.3+", 0)");p.append("g").selectAll("rect").data(d.range().map(a=>{let e=d.invertExtent(a);return null==e[0]&&(e[0]=c.domain()[0]),null==e[1]&&(e[1]=c.domain()[1]),e})).enter().append("rect").attr("fill",(a,e)=>d(a[0])).attr("x",(a,e)=>c(a[0])).attr("y",16).attr("width",(a,e)=>c(a[1])-c(a[0])).attr("height",(a,e)=>20),p.append("g").attr("transform","translate(0, 36)").call(h),p.append("text").attr("transform","translate("+n/5+", 11)").style("text-anchor","middle").text("Attainment (%)"),l.append("path").datum(topojson.mesh(e,e.objects.states,(a,e)=>a!==e)).attr("class","states").attr("d",r),l.append("g").attr("class","counties").selectAll("path").data(topojson.feature(e,e.objects.counties).features).enter().append("path").attr("class","county").attr("d",r).attr("fill",a=>d(t[a.id].bachelorsOrHigher)).attr("data-fips",a=>a.id).attr("data-education",a=>t[a.id].bachelorsOrHigher).on("mouseover",a=>i.style("display","block").attr("data-education",t[a.id].bachelorsOrHigher).text(s[t[a.id].state]+": "+t[a.id].area_name+": "+t[a.id].bachelorsOrHigher+"%")).on("mousemove",()=>i.style("top",d3.event.pageY-35+"px").style("left",d3.event.pageX+5+"px")).on("mouseout",()=>i.style("display","none"))})});